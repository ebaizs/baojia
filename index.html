<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>装饰项目清单报价系统</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    </head>
<body>
    <!-- 登录界面 -->
    <div id="login-container">
        <div class="login-box">
            <div class="login-logo">
                <h2><i class="fas fa-home"></i> 工程项目报价系统</h2>
                <p>请登录以继续使用</p>
            </div>
            
            <div id="login-loading" class="loading-spinner"></div>
            
            <div id="login-form">
                <div class="login-input-group">
                    <label for="username"><i class="fas fa-user"></i> 用户名</label>
                    <input type="text" id="username" class="login-input" placeholder="请输入用户名" autocomplete="username">
                </div>
                
                <div class="login-input-group">
                    <label for="password"><i class="fas fa-lock"></i> 密码</label>
                    <input type="password" id="password" class="login-input" placeholder="请输入密码" autocomplete="current-password">
                </div>
                
                <div id="login-error" class="login-error"></div>
                
                <button id="login-button" class="login-btn">
                    <i class="fas fa-sign-in-alt"></i> 登录
                </button>
                
                <div class="login-footer">
                    <p>系统版本 1.0 | 技术支持:  13515383180</p>
                    <p>© 2026 山东睿岩网络</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 原页面内容 -->
    <div id="main-container" style="display: none;">
        <div class="container">
           <header>
    <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px;">
        <div>
            <h1><i class="fas fa-home"></i> 项目清单报价系统</h1>
            <div class="header-subtitle"></div>
        </div>
    </div>
         <!-- 修改顶部按钮布局 -->
<div style="display: flex; flex-wrap: wrap; gap: 8px; align-items: center; margin-top: 15px;">
    <div style="display: flex; gap: 8px; flex-wrap: wrap;">
       
      <!-- 修改为乒乓开关 -->
<button class="btn btn-sm btn-outline" id="toggleAllCategoriesBtn" onclick="toggleAllCategories()"
title="快捷键: Alt+1">
<i class="fas fa-angle-double-down"></i> 
<span class="btn-text">全部展开</span>
</button>
        
      <!-- 修改为乒乓开关 -->
<button class="btn btn-sm btn-outline" id="toggleAllSpacesBtn" onclick="toggleAllSpaces()"
title="快捷键: Alt+2">
<i class="fas fa-layer-group"></i> 
<span class="btn-text">空间折叠</span>
</button>
    <!-- 桌面端显示导入导出按钮 -->
    <div class="desktop-actions" style="display: flex; gap: 8px; margin-left: auto;">
         <!-- 在 header 中添加快捷键提示 -->
<div style="font-size: 0.7rem; color: #cbd5e1; margin-top: 4px;">
    <i class="fas fa-keyboard"></i> 快捷键:  Alt+1 全部折叠/展开 | Alt+2 空间折叠/展开，ALT+E导出Excel
    </div>
        <button class="btn btn-info desktop-btn" onclick="importData()">
            <i class="fas fa-file-import"></i> <span class="desktop-btn-text">导入</span>
        </button>
        <button class="btn btn-info desktop-btn" onclick="exportData()">
            <i class="fas fa-file-export"></i> <span class="desktop-btn-text">导出</span>
        </button>
        <button class="btn btn-warning desktop-btn" onclick="logout()" title="退出登录">
            <i class="fas fa-sign-out-alt"></i> <span class="desktop-btn-text">退出</span>
        </button>
    </div>
</div>
        </header>
        

        
        <div class="tabs-container">
            <div class="tabs">
                <div class="tab active" data-tab="home">
                    <i class="fas fa-house"></i> <span class="tab-text">家装</span>
                </div>
                <div class="tab" data-tab="commercial">
                    <i class="fas fa-building"></i> <span class="tab-text">公装</span>
                </div>
                <div class="tab" data-tab="space">
                    <i class="fas fa-layer-group"></i> <span class="tab-text">空间库</span>
                </div>
                <div class="tab-export-btn" onclick="exportToExcel()">
                    <i class="fas fa-file-excel"></i> <span class="tab-text">导出Excel</span>
                </div>
            </div>
        </div>
        
        <!-- 家装板块 -->
        <div id="home-tab" class="tab-content active">
            <div class="section-card section-intro">
                <div class="section-header">
                    <div class="section-title">
                        <i class="fas fa-paint-roller"></i> 家装项目清单
                    </div>
                </div>
                <div class="section-subtitle">
                    添加您的家装项目，系统将自动分类统计
                </div>
                <div style="display:flex; flex-wrap: wrap; gap:10px; align-items:center;">
                    <input type="text" class="project-name-input" id="projectNameInput" 
                           placeholder="项目名称" value=""
                           style="flex:1; min-width: 200px;"
                           oninput="updateProjectNameFromInput(this)">
                    <button class="btn btn-primary" onclick="quickAddHomeProject()">
                        <i class="fas fa-bolt"></i> 快速模板
                    </button>
                    <button class="btn btn-success" onclick="clearAllProjects('home')">
                        <i class="fas fa-trash-alt"></i> 清空
                    </button>
                </div>
            </div>
            
            <!-- 基础装修 -->
            <div class="section-card category-section">
                <div class="section-header">
                    <div class="section-title collapsible" onclick="toggleCategoryCollapse('home', 'base')">
                        <i class="fas fa-hammer"></i> 基础装修
                        <span class="badge" id="home-base-count">0个项目</span>
                        <i class="fas fa-chevron-down collapse-icon" id="collapse-home-base"></i>
                    </div>
                    <div class="section-actions">
                        <button class="btn btn-primary btn-sm" onclick="openAddMultiModal('home', 'base')">
                            <i class="fas fa-plus"></i> 添加项目
                        </button>
                    </div>
                </div>
                <div id="home-base-content" class="category-content">
                    <div class="category-summary">
                        <div class="category-total">
                            总计: <span id="home-base-total">¥0.00</span>
                        </div>
                        <div class="space-filter">
                            <select class="form-select-sm" id="home-base-space-filter" onchange="filterProjectsBySpace('home', 'base')">
                                <option value="">全部空间</option>
                            </select>
                        </div>
                    </div>
                    <div class="item-list-scroll">
                        <div class="item-list" id="home-base-list">
                            <div class="empty-state">暂无项目，请添加</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 主要材料 -->
            <div class="section-card category-section">
                <div class="section-header">
                    <div class="section-title collapsible" onclick="toggleCategoryCollapse('home', 'auxiliary')">
                        <i class="fas fa-tools"></i> 主要材料
                        <span class="badge" id="home-auxiliary-count">0个项目</span>
                        <i class="fas fa-chevron-down collapse-icon" id="collapse-home-auxiliary"></i>
                    </div>
                    <div class="section-actions">
                        <button class="btn btn-primary btn-sm" onclick="openAddMultiModal('home', 'auxiliary')">
                            <i class="fas fa-plus"></i> 添加项目
                        </button>
                    </div>
                </div>
                <div id="home-auxiliary-content" class="category-content">
                    <div class="category-summary">
                        <div class="category-total">
                            总计: <span id="home-auxiliary-total">¥0.00</span>
                        </div>
                        <div class="space-filter">
                            <select class="form-select-sm" id="home-auxiliary-space-filter" onchange="filterProjectsBySpace('home', 'auxiliary')">
                                <option value="">全部空间</option>
                            </select>
                        </div>
                    </div>
                    <div class="item-list-scroll">
                        <div class="item-list" id="home-auxiliary-list">
                            <div class="empty-state">暂无项目，请添加</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 家具/电器及配饰 -->
            <div class="section-card category-section">
                <div class="section-header">
                    <div class="section-title collapsible" onclick="toggleCategoryCollapse('home', 'furniture')">
                        <i class="fas fa-couch"></i> 家具/电器及配饰
                        <span class="badge" id="home-furniture-count">0个项目</span>
                        <i class="fas fa-chevron-down collapse-icon" id="collapse-home-furniture"></i>
                    </div>
                    <div class="section-actions">
                        <button class="btn btn-primary btn-sm" onclick="openAddMultiModal('home', 'furniture')">
                            <i class="fas fa-plus"></i> 添加项目
                        </button>
                    </div>
                </div>
                <div id="home-furniture-content" class="category-content">
                    <div class="category-summary">
                        <div class="category-total">
                            总计: <span id="home-furniture-total">¥0.00</span>
                        </div>
                        <div class="space-filter">
                            <select class="form-select-sm" id="home-furniture-space-filter" onchange="filterProjectsBySpace('home', 'furniture')">
                                <option value="">全部空间</option>
                            </select>
                        </div>
                    </div>
                    <div class="item-list-scroll">
                        <div class="item-list" id="home-furniture-list">
                            <div class="empty-state">暂无项目，请添加</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 其它项 -->
            <div class="section-card category-section">
                <div class="section-header">
                    <div class="section-title collapsible" onclick="toggleCategoryCollapse('home', 'other')">
                        <i class="fas fa-ellipsis-h"></i> 其它项
                        <span class="badge" id="home-other-count">0个项目</span>
                        <i class="fas fa-chevron-down collapse-icon" id="collapse-home-other"></i>
                    </div>
                    <div class="section-actions">
                        <button class="btn btn-primary btn-sm" onclick="openAddMultiModal('home', 'other')">
                            <i class="fas fa-plus"></i> 添加项目
                        </button>
                    </div>
                </div>
                <div id="home-other-content" class="category-content">
                    <div class="category-summary">
                        <div class="category-total">
                            总计: <span id="home-other-total">¥0.00</span>
                        </div>
                        <div class="space-filter">
                            <select class="form-select-sm" id="home-other-space-filter" onchange="filterProjectsBySpace('home', 'other')">
                                <option value="">全部空间</option>
                            </select>
                        </div>
                    </div>
                    <div class="item-list-scroll">
                        <div class="item-list" id="home-other-list">
                            <div class="empty-state">暂无项目，请添加</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 统计汇总 -->
            <div class="section-card summary-section">
                <div class="section-header">
                    <div class="section-title">
                        <i class="fas fa-chart-pie"></i> 家装报价汇总
                    </div>
                </div>
                <div id="home-summary">
                    <div class="summary-row">
                        <div class="summary-label">
                            <i class="fas fa-hammer"></i> 基础装修
                        </div>
                        <div class="summary-value" id="home-base-summary">¥0.00</div>
                    </div>
                    <div class="summary-row">
                        <div class="summary-label">
                            <i class="fas fa-tools"></i> 主要材料
                        </div>
                        <div class="summary-value" id="home-auxiliary-summary">¥0.00</div>
                    </div>
                    <div class="summary-row">
                        <div class="summary-label">
                            <i class="fas fa-couch"></i> 家具家电及配饰
                        </div>
                        <div class="summary-value" id="home-furniture-summary">¥0.00</div>
                    </div>
                    <div class="summary-row">
                        <div class="summary-label">
                            <i class="fas fa-ellipsis-h"></i> 其它项
                        </div>
                        <div class="summary-value" id="home-other-summary">¥0.00</div>
                    </div>
                    <div class="summary-row total">
                        <div class="summary-label">
                            <i class="fas fa-file-invoice-dollar"></i> 合计
                        </div>
                        <div class="summary-value" id="home-grand-total">¥0.00</div>
                    </div>
                </div>
                <div class="summary-footer">
                    <div class="summary-note">
                        <i class="fas fa-info-circle"></i> 报价已包含材料及人工费，不含税金
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 公装板块 -->
        <div id="commercial-tab" class="tab-content">
            <div class="section-card section-intro">
                <div class="section-header">
                    <div class="section-title">
                        <i class="fas fa-building"></i> 公装项目清单
                    </div>
                </div>
                <div class="section-subtitle">
                    添加您的公装项目，系统将自动分类统计
                </div>
                <div style="display:flex; flex-wrap: wrap; gap:10px; align-items:center;">
                    <input type="text" class="project-name-input" id="projectNameInput2" 
                           placeholder="项目名称" value=""
                           style="flex:1; min-width: 200px;"
                           oninput="updateProjectNameFromInput(this)">
                    <button class="btn btn-primary" onclick="quickAddCommercialProject()">
                        <i class="fas fa-bolt"></i> 快速模板
                    </button>
                    <button class="btn btn-success" onclick="clearAllProjects('commercial')">
                        <i class="fas fa-trash-alt"></i> 清空
                    </button>
                </div>
            </div>
            
            <!-- 基础装修 -->
            <div class="section-card category-section">
                <div class="section-header">
                    <div class="section-title collapsible" onclick="toggleCategoryCollapse('commercial', 'base')">
                        <i class="fas fa-hard-hat"></i> 基础装修
                        <span class="badge" id="commercial-base-count">0个项目</span>
                        <i class="fas fa-chevron-down collapse-icon" id="collapse-commercial-base"></i>
                    </div>
                    <div class="section-actions">
                        <button class="btn btn-primary btn-sm" onclick="openAddMultiModal('commercial', 'base')">
                            <i class="fas fa-plus"></i> 添加项目
                        </button>
                    </div>
                </div>
                <div id="commercial-base-content" class="category-content">
                    <div class="category-summary">
                        <div class="category-total">
                            总计: <span id="commercial-base-total">¥0.00</span>
                        </div>
                        <div class="space-filter">
                            <select class="form-select-sm" id="commercial-base-space-filter" onchange="filterProjectsBySpace('commercial', 'base')">
                                <option value="">全部空间</option>
                            </select>
                        </div>
                    </div>
                    <div class="item-list-scroll">
                        <div class="item-list" id="commercial-base-list">
                            <div class="empty-state">暂无项目，请添加</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 主要材料 -->
            <div class="section-card category-section">
                <div class="section-header">
                    <div class="section-title collapsible" onclick="toggleCategoryCollapse('commercial', 'auxiliary')">
                        <i class="fas fa-box-open"></i> 主要材料
                        <span class="badge" id="commercial-auxiliary-count">0个项目</span>
                        <i class="fas fa-chevron-down collapse-icon" id="collapse-commercial-auxiliary"></i>
                    </div>
                    <div class="section-actions">
                        <button class="btn btn-primary btn-sm" onclick="openAddMultiModal('commercial', 'auxiliary')">
                            <i class="fas fa-plus"></i> 添加项目
                        </button>
                    </div>
                </div>
                <div id="commercial-auxiliary-content" class="category-content">
                    <div class="category-summary">
                        <div class="category-total">
                            总计: <span id="commercial-auxiliary-total">¥0.00</span>
                        </div>
                        <div class="space-filter">
                            <select class="form-select-sm" id="commercial-auxiliary-space-filter" onchange="filterProjectsBySpace('commercial', 'auxiliary')">
                                <option value="">全部空间</option>
                            </select>
                        </div>
                    </div>
                    <div class="item-list-scroll">
                        <div class="item-list" id="commercial-auxiliary-list">
                            <div class="empty-state">暂无项目，请添加</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 家具/电器及配饰 -->
            <div class="section-card category-section">
                <div class="section-header">
                    <div class="section-title collapsible" onclick="toggleCategoryCollapse('commercial', 'furniture')">
                        <i class="fas fa-desktop"></i> 家具/电器及配饰
                        <span class="badge" id="commercial-furniture-count">0个项目</span>
                        <i class="fas fa-chevron-down collapse-icon" id="collapse-commercial-furniture"></i>
                    </div>
                    <div class="section-actions">
                        <button class="btn btn-primary btn-sm" onclick="openAddMultiModal('commercial', 'furniture')">
                            <i class="fas fa-plus"></i> 添加项目
                        </button>
                    </div>
                </div>
                <div id="commercial-furniture-content" class="category-content">
                    <div class="category-summary">
                        <div class="category-total">
                            总计: <span id="commercial-furniture-total">¥0.00</span>
                        </div>
                        <div class="space-filter">
                            <select class="form-select-sm" id="commercial-furniture-space-filter" onchange="filterProjectsBySpace('commercial', 'furniture')">
                                <option value="">全部空间</option>
                            </select>
                        </div>
                    </div>
                    <div class="item-list-scroll">
                        <div class="item-list" id="commercial-furniture-list">
                            <div class="empty-state">暂无项目，请添加</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 公装其它项 -->
            <div class="section-card category-section">
                <div class="section-header">
                    <div class="section-title collapsible" onclick="toggleCategoryCollapse('commercial', 'other')">
                        <i class="fas fa-ellipsis-h"></i> 其它项
                        <span class="badge" id="commercial-other-count">0个项目</span>
                        <i class="fas fa-chevron-down collapse-icon" id="collapse-commercial-other"></i>
                    </div>
                    <div class="section-actions">
                        <button class="btn btn-primary btn-sm" onclick="openAddMultiModal('commercial', 'other')">
                            <i class="fas fa-plus"></i> 添加项目
                        </button>
                    </div>
                </div>
                <div id="commercial-other-content" class="category-content">
                    <div class="category-summary">
                        <div class="category-total">
                            总计: <span id="commercial-other-total">¥0.00</span>
                        </div>
                        <div class="space-filter">
                            <select class="form-select-sm" id="commercial-other-space-filter" onchange="filterProjectsBySpace('commercial', 'other')">
                                <option value="">全部空间</option>
                            </select>
                        </div>
                    </div>
                    <div class="item-list-scroll">
                        <div class="item-list" id="commercial-other-list">
                            <div class="empty-state">暂无项目，请添加</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 公装统计汇总 -->
            <div class="section-card summary-section">
                <div class="section-header">
                    <div class="section-title">
                        <i class="fas fa-chart-pie"></i> 公装报价汇总
                    </div>
                </div>
                <div id="commercial-summary">
                    <div class="summary-row">
                        <div class="summary-label">
                            <i class="fas fa-hard-hat"></i> 基础装修
                        </div>
                        <div class="summary-value" id="commercial-base-summary">¥0.00</div>
                    </div>
                    <div class="summary-row">
                        <div class="summary-label">
                            <i class="fas fa-box-open"></i> 主要材料
                        </div>
                        <div class="summary-value" id="commercial-auxiliary-summary">¥0.00</div>
                    </div>
                    <div class="summary-row">
                        <div class="summary-label">
                            <i class="fas fa-desktop"></i> 家具/电器及配饰
                        </div>
                        <div class="summary-value" id="commercial-furniture-summary">¥0.00</div>
                    </div>
                    <div class="summary-row">
                        <div class="summary-label">
                            <i class="fas fa-ellipsis-h"></i> 其它项
                        </div>
                        <div class="summary-value" id="commercial-other-summary">¥0.00</div>
                    </div>
                    <div class="summary-row total">
                        <div class="summary-label">
                            <i class="fas fa-file-invoice-dollar"></i> 合计
                        </div>
                        <div class="summary-value" id="commercial-grand-total">¥0.00</div>
                    </div>
                </div>
                <div class="summary-footer">
                    <div class="summary-note">
                        <i class="fas fa-info-circle"></i> 报价已包含人工、材料及管理费
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 空间库板块 -->
        <div id="space-tab" class="tab-content">
            <div class="section-card space-section">
                <div class="section-header">
                    <div class="section-title">
                        <i class="fas fa-layer-group"></i> 空间区域词库
                        <button class="btn btn-primary btn-sm" onclick="openSpaceModal()">
                            <i class="fas fa-plus"></i> 添加空间名
                        </button>
                    </div>
                </div>
                <div class="space-categories">
                    <div class="space-category">
                        <h4><i class="fas fa-home"></i> 家装常用空间</h4>
                        <div id="home-space-list" class="space-items"></div>
                    </div>
                    <div class="space-category">
                        <h4><i class="fas fa-building"></i> 公装常用空间</h4>
                        <div id="commercial-space-list" class="space-items"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 添加项目模态框（多选版本） -->
    <div class="modal" id="addMultiModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeMultiModal()">&times;</button>
            <div class="modal-header">
                <i class="fas fa-plus-circle"></i> 添加多个项目
            </div>
            <div class="form-row">
                <div class="form-group half">
                    <label class="form-label">
                        <i class="fas fa-layer-group"></i> 空间区域
                    </label>
                    <div class="input-with-button">
                        <select class="form-select" id="multiSpaceArea">
                            <option value="">请选择空间</option>
                        </select>
                        <button class="btn btn-sm btn-outline" onclick="openSpaceModal()">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- 手动输入单个项目 -->
            <div class="form-group">
                <label class="form-label">
                    <i class="fas fa-edit"></i> 手动添加单个项目
                </label>
                <div class="manual-input-section">
                    <div class="form-row compact">
                        <div class="form-group third">
                            <label class="form-label">项目名称</label>
                            <input type="text" class="form-input" id="manualProjectName" placeholder="名称">
                        </div>
                        <div class="form-group third">
                            <label class="form-label">单位</label>
                            <input type="text" class="form-input" id="manualProjectUnit" placeholder="单位" list="unitList">
                            <datalist id="unitList">
                                <option value="平米">平米</option>
                                <option value="米">米</option>
                                <option value="项">项</option>
                                <option value="套">套</option>
                                <option value="个">个</option>
                                <option value="张">张</option>
                                <option value="樘">樘</option>
                                <option value="组">组</option>
                            </datalist>
                        </div>
                        <div class="form-group third">
                            <label class="form-label">数量</label>
                            <input type="number" class="form-input" id="manualProjectQuantity" placeholder="1" min="1" step="1" value="1">
                        </div>
                    </div>
                    <div class="form-row compact">
                        <div class="form-group half">
                            <label class="form-label">单价 (¥)</label>
                            <input type="number" class="form-input" id="manualProjectPrice" placeholder="0.00" min="0" step="0.01">
                        </div>
                        <div class="form-group half">
                            <label class="form-label">工艺说明</label>
                            <div class="search-box" style="margin-bottom:0;">
                                <input type="text" class="form-input search-input" 
                                       id="manualProjectDescription" 
                                       placeholder="输入或搜索工艺说明..."
                                       onkeyup="searchProjectDescription(this.value)">
                                <i class="fas fa-search search-icon"></i>
                            </div>
                        </div>
                    </div>
                    <button class="btn btn-primary btn-sm" onclick="addManualProject()" style="width: 100%; margin-top: 8px;">
                        <i class="fas fa-plus"></i> 添加到当前列表
                    </button>
                </div>
            </div>
            
            <!-- 从项目库选择多个项目 -->
            <div class="form-group">
                <label class="form-label">
                    <i class="fas fa-list"></i> 选择项目（可多选）
                </label>
                <button class="btn btn-primary" onclick="openMultiSelectProjectLibrary()" style="width:100%;">
                    <i class="fas fa-list"></i> 从项目库选择多个项目
                </button>
                <div id="selected-projects-list" class="selected-projects-container">
                    <div class="empty-state">未选择任何项目</div>
                </div>
            </div>
            
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="addMultiProjects()">
                    <i class="fas fa-check"></i> 确认添加
                </button>
                <button class="btn btn-outline" onclick="closeMultiModal()">
                    <i class="fas fa-times"></i> 取消
                </button>
            </div>
        </div>
    </div>
    
    <!-- 项目库选择模态框（多选） -->
    <div class="modal" id="multiSelectProjectLibraryModal">
        <div class="modal-content" style="max-width:600px;">
            <button class="modal-close" onclick="closeMultiSelectProjectLibrary()">&times;</button>
            <div class="modal-header">
                <i class="fas fa-list"></i> 选择项目（可多选）
            </div>
            <div class="search-box">
                <input type="text" class="search-input" id="multi-project-search" placeholder="搜索项目名称..." onkeyup="searchMultiProjects()">
                <i class="fas fa-search search-icon"></i>
            </div>
            <div id="multi-project-library-list" class="project-library-list" style="max-height:400px;"></div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="confirmMultiSelection()">
                    <i class="fas fa-check"></i> 确认选择
                </button>
                <button class="btn btn-outline" onclick="closeMultiSelectProjectLibrary()">
                    <i class="fas fa-times"></i> 取消
                </button>
            </div>
        </div>
    </div>
    
    <!-- 空间选择/添加模态框 -->
    <div class="modal" id="spaceModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeSpaceModal()">&times;</button>
            <div class="modal-header">
                <i class="fas fa-layer-group"></i> 添加空间
            </div>
            <div class="form-group">
                <label class="form-label">空间名称</label>
                <input type="text" class="form-input" id="newSpaceName" placeholder="例如：客厅、主卧、会议室等">
            </div>
            <div class="form-group">
                <label class="form-label">空间类型</label>
                <select class="form-select" id="newSpaceType">
                    <option value="home">家装空间</option>
                    <option value="commercial">公装空间</option>
                </select>
            </div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="addNewSpace()">
                    <i class="fas fa-plus"></i> 添加到库
                </button>
                <button class="btn btn-outline" onclick="closeSpaceModal()">
                    <i class="fas fa-times"></i> 关闭
                </button>
            </div>
        </div>
    </div>
    
   <!-- 通知区域 -->
    <div id="notification-area"></div>
    
  <!-- 移动端底部工具栏 -->
<div class="mobile-bottom-bar">
    <button class="mobile-bottom-btn active" onclick="switchToTab('home')">
        <i class="fas fa-house"></i>
        <span class="mobile-btn-text">家装</span>
    </button>
    <button class="mobile-bottom-btn" onclick="switchToTab('commercial')">
        <i class="fas fa-building"></i>
        <span class="mobile-btn-text">公装</span>
    </button>
    <button class="mobile-bottom-btn" onclick="switchToTab('space')">
        <i class="fas fa-layer-group"></i>
        <span class="mobile-btn-text">空间库</span>
    </button>
    <button class="mobile-bottom-btn" onclick="importData()">
        <i class="fas fa-file-import"></i>
        <span class="mobile-btn-text">导入</span>
    </button>
    <button class="mobile-bottom-btn" onclick="exportData()">
        <i class="fas fa-file-export"></i>
        <span class="mobile-btn-text">导出</span>
    </button>
    <button class="mobile-bottom-btn" onclick="exportToExcel()">
        <i class="fas fa-file-excel"></i>
        <span class="mobile-btn-text">Excel</span>
    </button>
</div>
</body>
<!-- 修改后的脚本加载顺序 -->

<script src="data.js"></script>
<script src="script.js"></script>

</html>